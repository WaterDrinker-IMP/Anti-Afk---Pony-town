// XBXM Shutdown Script with Sad Effects, Music, and Auto-Refresh After 30 Seconds
(function () {
  const styles = `
    @keyframes rainbowGlow {
      0% { border-color: red; box-shadow: 0 0 10px red; }
      16% { border-color: orange; box-shadow: 0 0 10px orange; }
      33% { border-color: yellow; box-shadow: 0 0 10px yellow; }
      50% { border-color: green; box-shadow: 0 0 10px green; }
      66% { border-color: blue; box-shadow: 0 0 10px blue; }
      83% { border-color: indigo; box-shadow: 0 0 10px indigo; }
      100% { border-color: violet; box-shadow: 0 0 10px violet; }
    }

    @keyframes fall {
      to {
        transform: translateY(100vh);
        opacity: 0;
      }
    }

    .xbxm-loading, .xbxm-warning, .xbxm-shutdown {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.95);
      color: red;
      text-align: center;
      padding: 30px;
      border-radius: 15px;
      font-size: 18px;
      width: 500px;
      z-index: 10000;
      user-select: none;
      box-shadow: 0 0 15px red;
      animation: rainbowGlow 5s linear infinite;
    }

    .xbxm-loading h1,
    .xbxm-warning h1,
    .xbxm-shutdown h1 {
      font-size: 36px;
      font-weight: bold;
      margin: 0 0 20px 0;
      text-shadow: 0 0 5px red;
    }

    .xbxm-loading p,
    .xbxm-warning p,
    .xbxm-shutdown p {
      margin: 0 0 25px 0;
      line-height: 1.4;
      font-weight: 600;
      color: black;
    }

    .xbxm-warning button {
      padding: 14px 24px;
      font-weight: bold;
      background: #d00;
      border: none;
      color: white;
      font-size: 16px;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 8px #a00;
      transition: background 0.3s ease;
    }

    .xbxm-warning button:hover {
      background: #ff3333;
    }

    .xbxm-shutdown a {
      color: #007bff;
      text-decoration: underline;
      font-weight: bold;
    }

    .tear {
      position: fixed;
      top: -20px;
      left: calc(100% * var(--x));
      width: 10px;
      height: 20px;
      background: rgba(0,0,255,0.3);
      border-radius: 50%;
      animation: fall 2s linear infinite;
      pointer-events: none;
      z-index: 9999;
    }
  `;

  const styleSheet = document.createElement("style");
  styleSheet.textContent = styles;
  document.head.appendChild(styleSheet);

  // Step 1: Loading screen
  const loading = document.createElement("div");
  loading.className = "xbxm-loading";
  loading.innerHTML = `
    <h1>Loading XBXM Script...</h1>
    <p>Please wait while the script initializes.</p>
  `;
  document.body.appendChild(loading);

  setTimeout(() => {
    loading.remove();
    showWarning();
  }, 3000);

  // Step 2: Warning
  function showWarning() {
    const warning = document.createElement("div");
    warning.className = "xbxm-warning";
    warning.innerHTML = `
      <h1>WARNING</h1>
      <p>Please know that you are using this script at your own risk.<br>
      I am not responsible for any causes for YOUR account.<br>
      Please do NOT abuse this script or Iâ€™ll have to take it down.<br>
      This script was made for Education purposes.</p>
      <button id="agreeBtn">I agree to these terms.</button>
    `;
    document.body.appendChild(warning);

    document.getElementById("agreeBtn").onclick = () => {
      warning.remove();
      showShutdownMessage();
    };
  }

  // Step 3: Shutdown Message + Sad Music + Teardrops + Auto-Refresh
  function showShutdownMessage() {
    const shutdown = document.createElement("div");
    shutdown.className = "xbxm-shutdown";
    shutdown.innerHTML = `
      <h1>Script Shutdown</h1>
      <p>Sorry, this script has been shut down. :(</p>
      <p>
        Message me on 
        <a href="https://www.reddit.com/user/Icy-Bike-8265/" target="_blank">
          My Reddit
        </a> 
        for any questions or ideas for scripts :D<br>
        Stay tuned for more scripts in the future.
      </p>
    `;
    document.body.appendChild(shutdown);

    // Sad music
    const audio = new Audio("https://cdn.pixabay.com/audio/2023/04/10/audio_c428349bae.mp3");
    audio.loop = true;
    audio.volume = 0.5;
    audio.play().catch(() => {});

    // Teardrop effect
    const createTear = () => {
      const tear = document.createElement("div");
      tear.className = "tear";
      tear.style.setProperty('--x', Math.random());
      document.body.appendChild(tear);
      setTimeout(() => tear.remove(), 2000);
    };
    const tearInterval = setInterval(createTear, 200);

    // Auto refresh after 30 seconds
    const refreshTimer = setTimeout(() => {
      location.reload();
    }, 30000);

    // Optional: allow click to dismiss music/tears manually
    shutdown.onclick = () => {
      audio.pause();
      clearInterval(tearInterval);
      clearTimeout(refreshTimer);
      shutdown.remove();
    };
  }
})();
